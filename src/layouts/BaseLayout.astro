---
import NavBar from '../components/NavBar.astro';
import Footer from '../components/Footer.astro';
import '../styles/tokens.css';

export interface Props {
  title: string;
  description: string;
  lang: 'en' | 'pl' | 'de';
  ogImage?: string;
}

const { title, description, lang, ogImage } = Astro.props;

// Define alternate URLs for hreflang
const baseUrl = 'https://janczura.com';
const currentPath = Astro.url.pathname;
const alternateUrls = {
  en: `${baseUrl}${currentPath.replace(/^\/(pl|de)/, '/en')}/`,
  pl: `${baseUrl}${currentPath.replace(/^\/(en|de)/, '/pl')}/`,
  de: `${baseUrl}${currentPath.replace(/^\/(en|pl)/, '/de')}/`,
};
---

<html lang={lang} data-theme="light">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="author" content="Jacek Janczura" />
    <meta name="keywords" content="Jacek Janczura, AI Architect, CTO, Enterprise AI, LLM Platforms, RAG Systems, Cloud Architecture, ISO 27001, SOC 2, Process Intelligence, AI Native Systems, Berlin, Germany" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <link rel="canonical" href={`${baseUrl}${currentPath}`} />

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage || `${baseUrl}/images/headshot.jpg`} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={`${baseUrl}${currentPath}`} />
    <meta property="og:site_name" content="Jacek Janczura" />
    <meta property="og:locale" content={lang === 'en' ? 'en_US' : lang === 'pl' ? 'pl_PL' : 'de_DE'} />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage || `${baseUrl}/images/headshot.jpg`} />
    <meta name="twitter:creator" content="@jacekjanczura" />
    <meta name="twitter:site" content="@jacekjanczura" />

    <!-- Hreflang alternates -->
    <link rel="alternate" hreflang="en" href={alternateUrls.en} />
    <link rel="alternate" hreflang="pl" href={alternateUrls.pl} />
    <link rel="alternate" hreflang="de" href={alternateUrls.de} />
    <link rel="alternate" hreflang="x-default" href={alternateUrls.en} />

    <!-- Google Fonts - Lato -->
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- CSP Meta -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; img-src 'self' data: https:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; script-src 'self' 'unsafe-inline'; frame-src https://www.youtube.com https://www.youtube-nocookie.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self';"
    />

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json" is:inline>
      {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Jacek Janczura",
        "alternateName": "Jacek Janczura",
        "jobTitle": "AI Architect & CTO",
        "description": "Co-founder & CTO at Jaden Data. AI and Cloud Architect specializing in enterprise LLM platforms, RAG systems, and secure cloud architectures. Transforming operational complexity into competitive advantage through process intelligence.",
        "url": "https://janczura.com",
        "image": "https://janczura.com/images/headshot.jpg",
        "sameAs": [
          "https://linkedin.com/in/jacekjanczura",
          "https://github.com/jjanczur"
        ],
        "knowsAbout": [
          "Artificial Intelligence",
          "Machine Learning",
          "LLM Platforms",
          "Retrieval-Augmented Generation",
          "RAG Systems",
          "Cloud Architecture",
          "AWS",
          "Azure",
          "Distributed Systems",
          "Microservices",
          "Cybersecurity",
          "ISO 27001",
          "SOC 2",
          "Process Intelligence",
          "Enterprise AI",
          "AI Native Systems",
          "Event-Driven Architecture",
          "Serverless Computing"
        ],
        "hasOccupation": {
          "@type": "Occupation",
          "name": "AI Architect & CTO",
          "occupationLocation": {
            "@type": "City",
            "name": "Berlin",
            "@id": "https://www.wikidata.org/wiki/Q64"
          },
          "skills": [
            "Enterprise LLM Platforms",
            "RAG Systems",
            "Cloud Architecture",
            "Security & Compliance",
            "Technical Leadership"
          ]
        },
        "worksFor": {
          "@type": "Organization",
          "name": "Jaden Data",
          "url": "https://jaden-data.com"
        },
        "alumniOf": [
          {
            "@type": "EducationalOrganization",
            "name": "Technische Universit√§t Berlin"
          },
          {
            "@type": "EducationalOrganization",
            "name": "Warsaw University of Technology"
          }
        ],
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Berlin",
          "addressCountry": "DE"
        }
      }
    </script>

    <!-- Theme initialization -->
    <script is:inline>
      // Simple theme initialization - read from localStorage
      try {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.dataset.theme = savedTheme;
      } catch {
        // localStorage not available, use default light theme
        document.documentElement.dataset.theme = 'light';
      }
    </script>
  </head>
  <body>
    <NavBar lang={lang} />
    <main style="min-height: calc(100vh - 64px - 120px);">
      <slot />
    </main>
    <Footer lang={lang} />
  </body>
</html>
